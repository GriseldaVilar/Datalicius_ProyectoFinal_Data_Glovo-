---
title: "Analysis&Quality Data R Dataset Final Report1"
output: pdf_document
date: "2023-02-10"
---

Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see https://quarto.org.

Running Code

When you click the Render button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
library(tidyverse)
ruta_csv  <- "/Users/griseldacode/Desktop/PROYECTO FINAL DATALICIUS/R/df_madridfinalnanfinal.csv"
```

```{r}
df_madrid_final <- read.csv(ruta_csv , sep=",", na.strings = "")
#To carry out an analysis of the Na values and missing values on the original data base, we replaced the spaces with na.strings = ""
```

Exploration and evaluation

Data frame structure and composition:

```{r}
dim(df_madrid_final )
ncol(df_madrid_final )
length(df_madrid_final )
```

```{r}
names(df_madrid_final )
```

Types of objects and classes of the data and each variable:

```{r}
class(df_madrid_final)
sapply(df_madrid_final, class)
#str(df_madrid_final)
```

Summary of data and structure:

```{r}
#str(df_madrid_final)
#summary(df_madrid_final)
```

Empty values in a selected column:

```{r}
#is.na(df_madrid_final$Price_new)
#is.na(df_madrid_final$Number.of.Reviews)
#is.na(df_madrid_final$Bathrooms_new)
```

Missing values for each variable:

```{r}
colSums(is.na(df_madrid_final))
```

To calculate threshold of lost data, if the percentage is higher than 5% we must evaluate  to eliminate the data or recover information

Function for absent percentages for each variable:

```{r}
MissingValuesPercentagefinal <- function(x) {sum(is.na(x)) / length(x)*89}
apply(df_madrid_final, 2, MissingValuesPercentagefinal)
```

To estimate the exact amount of missing data per variable to assess the quality of the data frame:

```{r}
apply(df_madrid_final, MARGIN = -1, function(x) sum(is.na(x))) 
```

To check unique values for each variable:

```{r}
#df_madrid_final %>% summarise_all(funs(n_distinct(.)))
```

```{r}
#unique(df_madrid_final$Price_new)
#unique(df_madrid_final$Number.of.Reviews)
#unique(df_madrid_final$Neighbourhood.Cleansed)
```

Data frame values and NA:

```{r}
#summary(df_madrid_final) Of the entire data frame
summary(df_madrid_final$Price_new)
```

To check true or false values according to variable distribution in the data:

```{r}
#is.na(df_madrid_final) %>%
#head()
```

Visualization and Evaluation the quality of the original data

Graph 1. Proportion of missing data to compare the quality of the integer and numeric variables

```{r}
library(visdat)
df_visualization1_final <- df_madrid_final[,c('Host.Response.Rate', 'Host.Total.Listings.Count', 'Bedrooms_new', 'Bathrooms_new', 'Beds_new', 'Price_new','Price_new_weekly', 'Security.Deposit', 'Price_new_monthly', 'Cleaning.Fee', 'Review.Scores.Rating', 'Review.Scores.Value', 'Review.Scores.Location', 'Number.of.Reviews', 'Accommodates', 'Calculated.host.listings.count')]
vis_dat(df_visualization1_final)
```

Graph 2. Percentages of missing data in the data frame

```{r}
vis_miss(df_visualization1_final,sort_miss = TRUE) 
```

Graph 3. Cluster of missing data

```{r}
vis_miss(df_visualization1_final,sort_miss = TRUE, cluster = TRUE)
```

Variables and missing data

```{r}
library(naniar)
n_var_miss(df_visualization1_final)
```

Graph 4. Number of missing values in each variable

```{r}
gg_miss_var(df_visualization1_final, show_pct = TRUE)
```

Graph 5. Number of missings by a categorical variable

```{r}
library(ggplot2)
data_visualitation_intfinal = df_madrid_final[,c('Host.Response.Rate', 'Host.Total.Listings.Count', 'Bedrooms_new', 'Bathrooms_new', 'Beds_new', 'Price_new','Price_new_weekly', 'Security.Deposit', 'Price_new_monthly', 'Cleaning.Fee', 'Review.Scores.Rating', 'Review.Scores.Value', 'Review.Scores.Location', 'Number.of.Reviews', 'Accommodates', 'Room.Type', 'Calculated.host.listings.count')]
gg_miss_fct(x= data_visualitation_intfinal, fct = Room.Type)
```

